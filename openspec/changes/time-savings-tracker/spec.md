# æ™‚é–“ç¯€çœè¿½è¹¤åŠŸèƒ½

## æ¦‚è¿°

åœ¨ Shopline Category Manager ä¸­åŠ å…¥æ™‚é–“ç¯€çœè¿½è¹¤åŠŸèƒ½ï¼Œé‡åŒ–å·¥å…·ç‚ºä½¿ç”¨è€…ç¯€çœçš„æ™‚é–“ï¼Œæå‡ç”¢å“åƒ¹å€¼æ„ŸçŸ¥ã€‚

## å‹•æ©Ÿ

### å•é¡Œé™³è¿°
- ä½¿ç”¨è€…ç„¡æ³•ç›´è§€æ„Ÿå—åˆ°ä½¿ç”¨å·¥å…·ç›¸æ¯”æ‰‹å‹•æ‹–å‹•çš„æ•ˆç‡æå‡
- ç¼ºä¹æ•¸æ“šæ”¯æŒç”¢å“ ROIï¼ˆæŠ•è³‡å›å ±ç‡ï¼‰è¨ˆç®—
- ç„¡æ³•è¿½è¹¤ç´¯ç©çš„ç”Ÿç”¢åŠ›æå‡

### ç›®æ¨™
1. æä¾›å³æ™‚æ™‚é–“ç¯€çœåé¥‹ï¼ˆæ¯æ¬¡ç§»å‹•å¾Œï¼‰
2. è¿½è¹¤ä¸¦é¡¯ç¤ºç´¯ç©çš„æ™‚é–“ç¯€çœçµ±è¨ˆ
3. å¢å¼·ç”¢å“åƒ¹å€¼æ„ŸçŸ¥å’Œä½¿ç”¨è€…æ»¿æ„åº¦

## åŠŸèƒ½ç¯„åœ

### Phase 1: éœæ…‹ä¼°ç®—æ¨¡å‹ âœ…
**å³æ™‚æ™‚é–“ç¯€çœè¨ˆç®—å’Œé¡¯ç¤º**

#### 1.1 æ™‚é–“è¨ˆç®—å…¬å¼
```javascript
calculateTimeSaved(categoryCount, targetLevel, usedSearch)
```

**åƒæ•¸**ï¼š
- `categoryCount`: åˆ†é¡ç¸½æ•¸ï¼ˆå½±éŸ¿æ²å‹•å°‹æ‰¾æ™‚é–“ï¼‰
- `targetLevel`: ç›®æ¨™å±¤ç´š 1-3ï¼ˆå½±éŸ¿å°é½Šæ™‚é–“ï¼‰
- `usedSearch`: æ˜¯å¦ä½¿ç”¨æœå°‹åŠŸèƒ½ï¼ˆå½±éŸ¿å·¥å…·ä½¿ç”¨æ™‚é–“ï¼‰

**è¨ˆç®—é‚è¼¯**ï¼š
```
æ‹–å‹•æ™‚é–“ = åŸºç¤æ™‚é–“(4ç§’) +
          (åˆ†é¡æ•¸ / 10) Ã— 0.5ç§’ +
          ç›®æ¨™å±¤ç´š Ã— 1ç§’

å·¥å…·æ™‚é–“ = 2.5ç§’ï¼ˆä½¿ç”¨æœå°‹ï¼‰æˆ– 3.5ç§’ï¼ˆç€è¦½é¸å–®ï¼‰

ç¯€çœæ™‚é–“ = max(0, æ‹–å‹•æ™‚é–“ - å·¥å…·æ™‚é–“)
```

#### 1.2 å³æ™‚åé¥‹é¡¯ç¤º
- åœ¨ `moveCategory` æˆåŠŸå¾Œé¡¯ç¤ºæ™‚é–“ç¯€çœè¨Šæ¯
- æ ¼å¼ï¼šã€Œâœ… ç§»å‹•æˆåŠŸï¼â±ï¸ ç¯€çœäº† X ç§’ã€
- ä½¿ç”¨ç¾æœ‰çš„ `showSuccessMessage` æ–¹æ³•

### Phase 2: ç´¯ç©çµ±è¨ˆè¿½è¹¤ âœ…
**é•·æœŸä½¿ç”¨æ•¸æ“šè¿½è¹¤å’Œå±•ç¤º**

#### 2.1 TimeSavingsTracker é¡åˆ¥
æŒä¹…åŒ–å„²å­˜ä½¿ç”¨çµ±è¨ˆï¼š
- `totalMoves`: ç¸½ç§»å‹•æ¬¡æ•¸
- `totalTimeSaved`: ç´¯ç©ç¯€çœæ™‚é–“ï¼ˆç§’ï¼‰
- `lastReset`: çµ±è¨ˆé–‹å§‹æ—¥æœŸ

**å„²å­˜æ©Ÿåˆ¶**ï¼š
- ä½¿ç”¨ `localStorage`ï¼ˆkey: `categoryMoveStats`ï¼‰
- æ¯æ¬¡æˆåŠŸç§»å‹•å¾Œæ›´æ–°

#### 2.2 çµ±è¨ˆæŸ¥è©¢åŠŸèƒ½
```javascript
getStats() â†’ {
  totalMoves: number,
  totalSeconds: number,
  totalMinutes: number,
  avgPerMove: number,
  startDate: string
}
```

#### 2.3 Tampermonkey é¸å–®æ•´åˆ
**æ–°å¢é¸å–®é …ç›®**ï¼š
- ğŸ“Š æŸ¥çœ‹æ™‚é–“çµ±è¨ˆ - é¡¯ç¤ºç´¯ç©æ•¸æ“š
- ğŸ”„ é‡ç½®çµ±è¨ˆ - æ¸…ç©ºæ‰€æœ‰çµ±è¨ˆæ•¸æ“š

**éœ€è¦çš„ @grant æ¬Šé™**ï¼š
```
// @grant        GM_registerMenuCommand
// @grant        GM_getValue
// @grant        GM_setValue
```

## æŠ€è¡“è¦æ ¼

### æ–°å¢çš„å·¥å…·å‡½æ•¸
```javascript
// Phase 1
function calculateTimeSaved(categoryCount, targetLevel, usedSearch)

// Phase 2
class TimeSavingsTracker {
  constructor()
  loadStats()
  saveStats()
  recordMove(categoryCount, targetLevel, usedSearch)
  getStats()
  showStats()
  resetStats()
}
```

### æ•´åˆé»

#### 1. moveCategory æ–¹æ³•
```javascript
// åœ¨ moveCategory æˆåŠŸåˆ†æ”¯åŠ å…¥
if (success) {
  // ç¾æœ‰ç¨‹å¼ç¢¼
  this.showSuccessMessage('åˆ†é¡ç§»å‹•æˆåŠŸï¼');

  // æ–°å¢ï¼šè¿½è¹¤æ™‚é–“ç¯€çœ
  const timeSaved = this.tracker.recordMove(
    this.categories.length + this.posCategories.length,
    targetLevel,
    usedSearch
  );

  // æ›´æ–°æˆåŠŸè¨Šæ¯
  this.showSuccessMessage(
    `âœ… ç§»å‹•æˆåŠŸï¼\nâ±ï¸  ç¯€çœäº† ${timeSaved.thisMove} ç§’`
  );
}
```

#### 2. CategoryManager å»ºæ§‹å­
```javascript
constructor(scope) {
  // ç¾æœ‰ç¨‹å¼ç¢¼...

  // æ–°å¢ï¼šåˆå§‹åŒ–æ™‚é–“è¿½è¹¤å™¨
  this.tracker = new TimeSavingsTracker();
}
```

#### 3. UserScript Metadata
```diff
// @match        https://*.shopline.app/admin/*/categories*
- // @grant        none
+ // @grant        GM_registerMenuCommand
+ // @grant        GM_getValue
+ // @grant        GM_setValue
// ==/UserScript==
```

## ä½¿ç”¨è€…é«”é©—

### å³æ™‚åé¥‹ï¼ˆPhase 1ï¼‰
```
ä½¿ç”¨è€…æ“ä½œæµç¨‹ï¼š
1. é»æ“Šã€Œç§»å‹•åˆ°ã€æŒ‰éˆ•
2. é¸æ“‡ç›®æ¨™åˆ†é¡
3. ç¢ºèªç§»å‹•
4. çœ‹åˆ°è¨Šæ¯ï¼šã€Œâœ… ç§»å‹•æˆåŠŸï¼â±ï¸ ç¯€çœäº† 5.5 ç§’ã€
```

### çµ±è¨ˆæŸ¥è©¢ï¼ˆPhase 2ï¼‰
```
ä½¿ç”¨è€…æ“ä½œæµç¨‹ï¼š
1. é»æ“Š Tampermonkey åœ–ç¤º
2. é¸æ“‡ã€ŒğŸ“Š æŸ¥çœ‹æ™‚é–“çµ±è¨ˆã€
3. çœ‹åˆ°å½ˆçª—ï¼š
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   ğŸ“Š æ™‚é–“ç¯€çœçµ±è¨ˆ
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ç¸½ç§»å‹•æ¬¡æ•¸: 45 æ¬¡
   ç¯€çœæ™‚é–“: 4 åˆ† 15 ç§’
   å¹³å‡æ¯æ¬¡: 5.7 ç§’
   é–‹å§‹æ—¥æœŸ: 2026-01-15
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

## æ¸¬è©¦è¨ˆåŠƒ

### å–®å…ƒæ¸¬è©¦
- [ ] `calculateTimeSaved` å„ç¨®åƒæ•¸çµ„åˆçš„æ­£ç¢ºæ€§
- [ ] `TimeSavingsTracker.recordMove` ç´¯ç©è¨ˆç®—æ­£ç¢º
- [ ] `TimeSavingsTracker.resetStats` æ¸…ç©ºçµ±è¨ˆ

### æ•´åˆæ¸¬è©¦
- [ ] ç§»å‹•æˆåŠŸå¾Œé¡¯ç¤ºæ­£ç¢ºçš„æ™‚é–“ç¯€çœè¨Šæ¯
- [ ] localStorage æŒä¹…åŒ–æ­£å¸¸é‹ä½œ
- [ ] Tampermonkey é¸å–®é …ç›®å¯æ­£å¸¸è§¸ç™¼

### ä½¿ç”¨è€…æ¸¬è©¦
- [ ] ä¸åŒåˆ†é¡æ•¸é‡ä¸‹çš„æ™‚é–“ä¼°ç®—æ˜¯å¦åˆç†
- [ ] çµ±è¨ˆæ•¸æ“šæ˜¯å¦æº–ç¢ºç´¯ç©
- [ ] é‡ç½®åŠŸèƒ½æ˜¯å¦æ­£å¸¸

## éåŠŸèƒ½æ€§éœ€æ±‚

### æ•ˆèƒ½
- æ™‚é–“è¨ˆç®—ä¸æ‡‰å½±éŸ¿ç§»å‹•æ“ä½œæ•ˆèƒ½ï¼ˆ< 1msï¼‰
- localStorage æ“ä½œæ‡‰ä½¿ç”¨ try-catch é˜²æ­¢éŒ¯èª¤

### ç›¸å®¹æ€§
- æ”¯æ´æ‰€æœ‰å·²æ”¯æ´çš„ç€è¦½å™¨ï¼ˆChrome, Firefox, Safari, Edgeï¼‰
- å‘ä¸‹ç›¸å®¹ï¼šæœªå•Ÿç”¨ GM_* æ¬Šé™æ™‚åŠŸèƒ½å„ªé›…é™ç´š

### å®‰å…¨æ€§
- localStorage æ•¸æ“šåƒ…å­˜æ–¼æœ¬åœ°ï¼Œä¸æ¶‰åŠéš±ç§å•é¡Œ
- ä¸æ”¶é›†ä»»ä½•ä½¿ç”¨è€…å€‹äººè³‡è¨Š

## å¾ŒçºŒéšæ®µï¼ˆPhase 3ï¼ŒæœªåŒ…å«åœ¨æ­¤ changeï¼‰

### è¦–è¦ºåŒ–å„€è¡¨æ¿
- æ™‚é–“ç¯€çœè¶¨å‹¢åœ–è¡¨
- åˆ†é¡å±¤ç´šåˆ†ä½ˆåœ–
- æ¯æ—¥/æ¯é€±çµ±è¨ˆ
- åŒ¯å‡º CSV å ±å‘Š

## æˆåŠŸæŒ‡æ¨™

- âœ… Phase 1 å®Œæˆï¼š100% ç§»å‹•æ“ä½œé¡¯ç¤ºæ™‚é–“ç¯€çœ
- âœ… Phase 2 å®Œæˆï¼šçµ±è¨ˆæ•¸æ“šæ­£ç¢ºç´¯ç©ä¸¦å¯æŸ¥è©¢
- âœ… ä½¿ç”¨è€…åé¥‹ï¼šæ™‚é–“ä¼°ç®—åˆç†ï¼ˆÂ±20% èª¤å·®ç¯„åœå…§ï¼‰

## åƒè€ƒè³‡æ–™

### æ™‚é–“ä¼°ç®—ç ”ç©¶åŸºç¤
- æ‰‹å‹•æ‹–å‹•å¹³å‡æ™‚é–“ï¼š8-9 ç§’ï¼ˆå¯¦éš›æ¸¬è©¦ï¼‰
- å·¥å…·æ“ä½œå¹³å‡æ™‚é–“ï¼š2-4 ç§’ï¼ˆå¯¦éš›æ¸¬è©¦ï¼‰
- å¹³å‡ç¯€çœï¼š5-7 ç§’/æ¬¡

### ç«¶å“åˆ†æ
- ç„¡é¡ä¼¼åŠŸèƒ½çš„ UserScript å·¥å…·æä¾›æ™‚é–“è¿½è¹¤
- æ­¤åŠŸèƒ½ç‚ºå·®ç•°åŒ–å„ªå‹¢
