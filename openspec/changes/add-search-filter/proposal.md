# Proposal: Add Search Filter to Move Dropdown

**Change ID**: `add-search-filter`
**Branch**: `search-node`
**Status**: Draft
**Created**: 2026-01-09

## Summary

在「移動到」浮動視窗頂部新增搜尋欄，讓使用者可以快速過濾並選擇 Level 1 父項目，選中後按確認按鈕執行移動。

## Motivation

當分類數量眾多（100+）時，從樹狀選單中找到目標父項目需要滾動瀏覽。新增搜尋功能可以：
- 減少尋找時間（輸入關鍵字即時過濾）
- 降低操作錯誤（精確定位目標）
- 提升使用體驗（符合使用者直覺）

## Requirements

### R1: 搜尋欄 UI
- 位置：浮動視窗頂部（樹狀選單上方）
- 元素：文字輸入框 + placeholder「搜尋父項目...」
- 樣式：與現有視窗風格一致

### R2: 搜尋範圍
- **僅搜尋 Level 1 分類**（根目錄的直接子項）
- 不顯示 Level 2、Level 3 分類
- 排除系統分類（`key` 屬性為 true 的項目）

### R3: 過濾行為
- **即時過濾**：輸入時立即更新結果列表
- **模糊匹配**：輸入「鞋」可匹配「運動鞋」、「皮鞋」等
- **大小寫不敏感**：「ABC」匹配「abc」
- **空白輸入**：顯示所有 Level 1 項目

### R4: 搜尋結果顯示
- 結果列表位於搜尋欄下方
- 每個結果項目可點擊選中
- 選中項目高亮顯示
- 無結果時顯示「無符合項目」

### R5: 確認按鈕
- 位置：搜尋結果列表下方
- 文字：「確認移動」
- 狀態：
  - 未選中任何項目 → 按鈕禁用（灰色）
  - 已選中項目 → 按鈕啟用
- 點擊後執行移動操作

### R6: 與原有樹狀選單共存
- 搜尋區塊在上方
- 原有樹狀選單在下方
- 分隔線區分兩區塊
- 兩種方式都可完成移動

## UI Mockup (ASCII)

```
┌─────────────────────────────────┐
│ 🔍 搜尋父項目...                │  ← 搜尋輸入框
├─────────────────────────────────┤
│ ○ 運動鞋                        │  ← 過濾結果 (Level 1 only)
│ ● 皮鞋           ← 已選中       │
│ ○ 休閒鞋                        │
├─────────────────────────────────┤
│      [ 確認移動 ]               │  ← 確認按鈕
├─────────────────────────────────┤
│ ─── 或從樹狀結構選擇 ───        │  ← 分隔線
├─────────────────────────────────┤
│ 📂 根目錄                       │  ← 原有樹狀選單
│ ├─ 分類A                        │
│ │  └─ 分類A-1                   │
│ ├─ 分類B                        │
│ ...                             │
└─────────────────────────────────┘
```

## Out of Scope

- 搜尋 Level 2/3 分類（未來可擴展）
- 多選移動（一次移動多個分類）
- 搜尋歷史記錄
- 鍵盤快捷鍵（上下選擇、Enter 確認）

## Risks & Mitigations

| Risk | Impact | Mitigation |
|------|--------|------------|
| 大量分類時過濾性能 | 輸入延遲 | 使用 debounce（200ms） |
| 搜尋欄佔用視窗空間 | 視窗過高 | 限制結果列表最多 5 項，可滾動 |
| 與原有選單混淆 | 使用者困惑 | 清晰分隔線 + 說明文字 |

## Success Criteria

- [ ] 搜尋欄出現在浮動視窗頂部
- [ ] 輸入關鍵字即時過濾 Level 1 分類
- [ ] 模糊匹配正常運作
- [ ] 選中項目後確認按鈕啟用
- [ ] 點擊確認按鈕成功移動分類
- [ ] 原有樹狀選單仍可正常使用
- [ ] 無 JavaScript 錯誤
